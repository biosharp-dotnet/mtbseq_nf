#+TITLE: Native Commands



* Native commands used by mtbseq based on the log of tbfull

This are the commands found on the mtbseq log related

** bwa mem
bwa for mapping
#+begin_src
 mem -t 2 -R t 2 -R '@RG\tID:5765_somelib\tSM:5765\tPL:Illumina\tLB:somelib' /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta  /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/5765_somelib_R1.fastq.gz /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/5765_somelib_R2.fastq.gz > /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.sam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog

#+end_src
** samtools view
samtools for converting from sam to bam
#+begin_src
samtools view -@ 2 -b -T /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta -o /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bam /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.sam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog
#+end_src
** samtools sort
 samtools for sortimg the bam file
 #+begin_src
samtools sort -@ 2 -T /tmp/5765_somelib.sorted -o /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.sorted.bam /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog
 #+end_src
** samtools index
samtools for indexing the sorted bam
#+begin_src
samtools index -b /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.sorted.bam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog
#+end_src
** samtools rmdup
samtools for removing putative pcr duplicates
#+begin_src
samtools rmdup /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.sorted.bam /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.nodup.bam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog

#+end_src
** samtools index
recreating the index after removing the pcr duplicates
#+begin_src
samtools index -b /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.nodup.bam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bamlog
#+end_src
** bwa mapping?
refining mappings:
*** GATK RealignerTargetCreator
#+begin_src
gatk --analysis_type RealignerTargetCreator --reference_sequence /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta --input_file /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bam --downsample_to_coverage 10000 --num_threads 2 --out /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.intervals 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bamlog

#+end_src
*** GATK IndelRealigner
#+begin_src
gatk --analysis_type IndelRealigner --reference_sequence /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta --input_file /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Bam/5765_somelib.bam --defaultBaseQualities 12 --targetIntervals /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.intervals --noOriginalAlignmentTags --out /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.realigned.bam 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bamlog

#+end_src
*** GATK BaseRecalibrator
#+begin_src
	gatk --analysis_type BaseRecalibrator --reference_sequence /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta --input_file /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.realigned.bam --knownSites /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/res/MTB_Base_Calibration_List.vcf --maximum_cycle_value 600 --num_cpu_threads_per_data_thread 2 --out /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.grp 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bamlog
#+end_src
*** GATK PrintReads
#+begin_src
	gatk -T --analysis_type PrintReads --reference_sequence /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta --input_file /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.realigned.bam --BQSR /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.grp --num_cpu_threads_per_data_thread 2 --out /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bam  2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bamlog
#+end_src
** mpileup creation
*** samtools mpileup
#+begin_src
samtools mpileup -B -A -x -f /root/miniconda3/envs/mtbseq/share/mtbseq-1.0.3-1/var/ref/M._tuberculosis_H37Rv_2015-11-13.fasta /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/GATK_Bam/5765_somelib.gatk.bam > /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Mpileup/5765_somelib.gatk.mpileup 2>> /var/lib/docker/volumes/minikube/_data/lib/docker/volumes/nftowervolume/_data/data/mtbseqtest_conda/Mpileup/5765_somelib.gatk.mpileuplog
#+end_src
** Creating position lists
** Variant callings
** Statistics for mapping
*** samtools
** Calling Strains
